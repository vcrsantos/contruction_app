{% extends "base.html" %}
{% block content %}

<h2>Novo Gasto</h2>

<form method="post">

  <!-- Valor -->
  <label>Valor</label>
  <input
    type="number"
    step="0.01"
    name="value"
    placeholder="Ex: 250.00"
    required
    autofocus
  >

  <!-- Categoria -->
  <label>Categoria</label>
  <select name="category_id" required>
    {% for c in categories %}
      <option value="{{ c[0] }}">{{ c[1] }}</option>
    {% endfor %}
  </select>

  <!-- Data -->
  <label>Data</label>
  <input
    type="date"
    name="date"
    value="{{ today | e }}"
    required
  >

  <!-- Casa -->
  <label>Casa</label>
  <select name="house_id" required>
    <option value="">Selecione a casa</option>
    {% for house in houses %}
      <option value="{{ house[0] }}">{{ house[1] }}</option>
    {% endfor %}
  </select>

  <!-- Observações -->
  <label>Observações</label>
  <textarea
    name="observations"
    placeholder="Detalhes adicionais sobre o gasto"
    rows="4"
  ></textarea>

  <!-- Botão -->
  <button type="submit">Salvar Gasto</button>

</form>

<hr>

<h2>Gastos Cadastrados</h2>

<table border="1" cellpadding="5" cellspacing="0" style="width: 100%;">
  <thead>
    <tr>
      <th>Valor</th>
      <th>Categoria</th>
      <th>Casa</th>
      <th>Data</th>
      <th>Observações</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for g in expenses %}
      <tr>
        <td>R$ {{ '%.2f'|format(g[1]) }}</td>
        <td>{{ g[2] }}</td>
        <td>{{ g[4] }}</td>
        <td>{{ g[3] }}</td>
        <td>{{ g[5][:50] if g[5] else '-' }}</td>
        <td>
          <a href="/edit-expense/{{ g[0] }}">✏️</a>
          <a href="/remove-expense/{{ g[0] }}">❌</a>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
